<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Friend Finder Survey</title>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>
</head>
<body>
	Completely abstract friend finder, find your true psychic soulmate!
	<form>
		<div>
			<label for="name">Please Enter your Name:</label>
			<input type="text" id="name" required>
		</div>
		<div>
			<label for="name">Please Link to a Photo Image:</label>
			<input type="text" id="pic" required>
		</div>
		<div id='questions'>
		</div>
		<div>
			<button type='submit'>Submit</button>
		</div>
	</form>

<div class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Your Psychic Soulmate!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div id="display-name"></div>
        <div id="diplay-pic"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
	$(document).ready(function(){
		var questions = "";
		for(var i = 1; i <= 10; i++){
			questions += "<div>";
			for(var j = 1; j <= 5; j++){
				questions += "<input type=radio id='q"+i+j+"' class='options' name='q"+i+"' value='"+j+"'>" +
				"<label for='q"+i+j+"'>"+j+"</label>";
			}
			questions += "</div>";	
		}
		$('#questions').html(questions);

		$('#submit').on('click', function(){
			event.preventDefault();

			function validateForm() {
				var isValid = true;
				$(".options").each(function(){
					if($(this).val() === ""){
						isValid = false;
					}
				});

				return isValid;
			}

			if (validateForm()) {
				var data = {
					name: $("#name").val(),
					pic: $("#pic").val(),
					ans: [
						$("#q1").val(),
						$("#q2").val(),
						$("#q3").val(),
						$("#q4").val(),
						$("#q5").val(),
						$("#q6").val(),
						$("#q7").val(),
						$("#q8").val(),
						$("#q9").val(),
						$("#q10").val()
					]
				};
			
				$.post("/api/friends", data, function(data){

					$("#display-name").text(data.name);
					$("#display-pic").attr("src", data.pic);

					$("#modal").modal("toggle");
				});
			} else {
				alert("Please answer all questions");
			}
		});
	});
</script>	
</body>
</html>